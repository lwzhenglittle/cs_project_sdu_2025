# SM3 算法优化实现

## 项目概述

本项目致力于 SM3 密码杂凑算法的实现与性能优化。项目中包含了 SM3 算法的基准实现以及多种不同优化策略的实现，旨在展示如何通过不同的软件优化技术提高算法执行效率。

## 文件结构

- `sm3.cpp` - SM3 算法的基准实现，着重于代码的可读性和正确性
- `opt1_unroll.cpp` - 循环展开优化实现
- `opt2_regalloc.cpp` - 寄存器分配优化实现
- `opt3_simd.cpp` - 使用 SIMD 指令集优化消息扩展
- `opt4_on_the_fly.cpp` - 即时计算优化实现
- `opt5_flatten.cpp` - 展平结构与宏优化实现
- `compile_all.sh` - 编译脚本，用于编译所有优化版本并进行简单测试

## 优化策略说明

1. **循环展开**：通过展开算法中的循环结构，减少循环控制开销，提高执行效率。

2. **寄存器分配优化**：通过优化变量在寄存器中的分配，减少内存访问，提高处理速度。

3. **SIMD 指令集优化**：利用 AVX2 等 SIMD（单指令多数据）指令集并行处理数据，大幅提升数据处理速度。

4. **即时计算优化**：改变计算流程，减少中间结果的存储需求，降低内存访问开销。

5. **展平结构与宏优化**：通过代码结构展平和宏定义，减少函数调用开销，提高编译优化效果。

## 编译与测试

编译命令：

```bash
./compile_all.sh
```

编译过程会为每个实现版本生成对应的 `.elf` 可执行文件，并进行简单的功能测试。

## 使用方法

所有实现版本都采用相同的输入/输出接口：从标准输入读取消息，将计算得到的 256 位杂凑值以十六进制格式输出到标准输出。

示例：

```bash
echo -n "abc" | ./sm3.elf
```

## 系统要求

- 支持 AVX2 指令集的 x86-64 处理器
- GCC 编译器（建议版本 9.0 或更高）
- Linux 操作系统